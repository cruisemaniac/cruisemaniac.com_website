<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://cruisemaniac.com/images/avatar.jpg"><meta name=twitter:title content="Get Vagrant running with berkshelf on Mavericks"><meta name=twitter:description content="Get Vagrant running with berkshelf on Mavericks - A problem I faced and what was required to get this running."><meta name=twitter:site content="@cruisemaniac"><meta name=twitter:creator content="@Ashwin M"><meta name=author content="Ashwin M"><meta name=description content="DevOps, Infra and Cloud Expert"><meta name=generator content="Hugo 0.85.0"><title>Get Vagrant running with berkshelf on Mavericks &#183; cruisemaniac.com</title><link href=https://fonts.googleapis.com rel=preconnect crossorigin=crossorigin><link href=https://fonts.gstatic.com rel=preconnect crossorigin=crossorigin><link href=https://www.google-analytics.com rel=preconnect crossorigin=crossorigin><link href=https://maxcdn.bootstrapcdn.com rel=preconnect crossorigin=crossorigin><link href=https://fonts.gstatic.com/s/notosans/v8/o-0IIpQlx3QUlC5A4PNr5TRASf6M7Q.woff2 rel=preload as=font crossorigin=crossorigin><link href=https://fonts.gstatic.com/s/dancingscript/v10/If2RXTr6YS-zF4S-kcSWSVi_szLgiuEHiC4W.woff2 rel=preload as=font crossorigin=crossorigin><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0" rel=preload as=font crossorigin=crossorigin><link rel=stylesheet href=https://cruisemaniac.com/css/style.css><link rel=preload href=https://cruisemaniac.com/css/highlight.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cruisemaniac.com/css/highlight.css></noscript><link rel=preload href=https://cruisemaniac.com/css/font-awesome.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cruisemaniac.com/css/font-awesome.min.css></noscript><link href=https://cruisemaniac.com/index.xml rel=alternate type=application/rss+xml title=cruisemaniac.com><link rel=preload href=https://cruisemaniac.com/css/custom.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cruisemaniac.com/css/custom.css></noscript><link rel="shortcut icon" href=https://cruisemaniac.com/images/favicon.png><script src=https://identity.netlify.com/v1/netlify-identity-widget.js></script></head><body><div id=page-container><section id=page-wrap><nav class=main-nav><a href=https://cruisemaniac.com/><span class=arrow>←</span>Home</a>
<a href=https://cruisemaniac.com/about>About</a>
<a href=https://cruisemaniac.com/tags>Tags</a>
<a href=https://cruisemaniac.com/projects-and-talks>Projects & Talks</a>
<a href=https://cruisemaniac.com/posts>Posts</a>
<a class=cta href=https://cruisemaniac.com/index.xml>RSS</a></nav><section id=wrapper class=post><article><header><h1>Get Vagrant running with berkshelf on Mavericks</h1><h2 class=headline>Sep 9, 2014 19:00
· 316 words
· 2 minute read
<span class=tags>|
<a href=https://cruisemaniac.com/tags/tech>tech</a> |
<a href=https://cruisemaniac.com/tags/mac>mac</a> |
<a href=https://cruisemaniac.com/tags/homebrew>homebrew</a> |
<a href=https://cruisemaniac.com/tags/ops>ops</a> |
<a href=https://cruisemaniac.com/tags/chef>chef</a> |
<a href=https://cruisemaniac.com/tags/vagrant>vagrant</a> |
<a href=https://cruisemaniac.com/tags/troubleshooting>troubleshooting</a> |</span></h2></header><section id=post-body><p>So, here I was trying to setup Vagrant on my Mac. Everything went fine till the <code>vagrant up</code> command and boom:</p><pre><code>myfirstvagrantproject $ vagrant up
Bringing machine 'projectname' up with 'virtualbox' provider...
==&gt; projectname: The cookbook path '/Users/cruisemaniac/.berkshelf/projectname/vagrant/berkshelf-20140909-37664-1gf5t34-projectname' doesn't exist. Ignoring...
Updating Vagrant's berkshelf: '/Users/cruisemaniac/.berkshelf/projectname/vagrant/berkshelf-20140909-37664-1gf5t34-projectname'
RuntimeError: Couldn't determine Berks version: #&lt;Buff::ShellOut::Response:0x00000101040360 @exitstatus=1, @stdout=&quot;&quot;, @stderr=&quot;/Users/cruisemaniac/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:298:in `to_specs': Could not find 'berkshelf' (&gt;= 0) among 56 total gem(s) (Gem::LoadError)\n\tfrom /Users/cruisemaniac/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/dependency.rb:309:in `to_spec'\n\tfrom /Users/cruisemaniac/.rbenv/versions/2.1.2/lib/ruby/2.1.0/rubygems/core_ext/kernel_gem.rb:53:in `gem'\n\tfrom /Users/cruisemaniac/.rbenv/versions/2.1.2/bin/berks:22:in `&lt;main&gt;'\n&quot;&gt;
</code></pre><p>I knew vagrant liked <code>chef_solo</code> and <code>berkshelf</code> to assist in the scripts that handle provisioning the VM. So I went ahead and installed the gems before starting out with the vagrant install.</p><p>What I could not understand was how berkshelf which was installed under my rbenv (via homebrew) was not found while the gem was being picked up right! &#171; I know, shitty!</p><p>My local setup gave me this:</p><pre><code>myfirstvagrantproject $ vagrant version
Installed Version: 1.6.5
Latest Version: 1.6.5
You're running an up-to-date version of Vagrant!

myfirstvagrantproject $ berks --version
3.1.5
myfirstvagrantproject $ which berks
/Users/cruisemaniac/.rbenv/shims/berks
</code></pre><p>All is well right? Well, No!</p><p>Apparently, the berkshelf gem used by vagrant requries <a href=https://downloads.getchef.com/chef-dk/>chefdk</a>, the chef development kit and wont work hanky panky without that.</p><blockquote><p>Remove any berkshelf AND chef gems from your ruby installationbefore you start off with the chefdk installation.</p></blockquote><p>Install chefdk into your <code>/opt</code> folder - again a requirement. Add this to the <code>.bash_profile</code> before your gems are loaded.</p><pre><code>export PATH=/opt/chefdk/bin
</code></pre><p>Reload your <code>.bash_profile</code> and you must be good to go.</p><p>The other option is that you dont use berkshelf with chef OR you use puppet.</p><p>If you dont want to use berkshelf, open the <code>Vagrantfile</code> and set the following to false:</p><pre><code>Vagrant.configure(&quot;2&quot;) do |config|
  config.berkshelf.enabled = false
  ...
  # other configuration code
</code></pre><p>You would also have to remove the <code>Berkshelf</code> file sitting in your vagrant directory to prevent Vagrant from complaining about an existing Berkshelf file that its not using!</p><p>Hope this helps.</p></section></article><div class=row><div class=col><div class="newsletter row justify-content-center"><div class="col-lg-8 content"><p>If you'd like me to keep you posted:</p><link href=//cdn-images.mailchimp.com/embedcode/classic-10_7.css rel=stylesheet type=text/css><style type=text/css>#mc_embed_signup{background:#fff;clear:left;font:14px Helvetica,Arial,sans-serif}</style><div id=mc_embed_signup><form action="https://cruisemaniac.us8.list-manage.com/subscribe/post?u=d89d3ff810090855c61f96d04&id=53364f8a35" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div id=mc_embed_signup_scroll><div class=indicates-required><span class=asterisk>*</span> indicates required</div><div class=mc-field-group><label for=mce-EMAIL>Email Address <span class=asterisk>*</span></label>
<input type=email name=EMAIL class="required email" id=mce-EMAIL></div><div class=mc-field-group><label for=mce-FNAME>Name</label>
<input type=text name=FNAME id=mce-FNAME></div><div id=mce-responses class=clear><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_d89d3ff810090855c61f96d04_53364f8a35 tabindex=-1></div><div class=clear><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class=button></div></div></form></div></div></div></div></div></section></section><footer id=footer><div id=social><a class=symbol href=https://github.com/cruisemaniac aria-label=github-square alt="view github-square profile"><i class="fa fa-github-square"></i></a>
<a class=symbol href=https://linkedin.com/in/ashwinmurali aria-label=linkedin-square alt="view linkedin-square profile"><i class="fa fa-linkedin-square"></i></a>
<a class=symbol href=https://twitter.com/cruisemaniac aria-label=twitter-square alt="view twitter-square profile"><i class="fa fa-twitter-square"></i></a></div><p class=small>© 2021. Bangalore <i class="fa fa-heart" aria-hidden=true></i>|
Ashwin M</p></footer></div><script src=https://code.jquery.com/jquery-3.4.0.min.js integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin=anonymous></script><script src=https://cruisemaniac.com/js/main.js></script><script data-goatcounter=https://cruisemaniac.goatcounter.com/count async src=//gc.zgo.at/count.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script></body></html>